<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add Product</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #ffffff;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin-top: 150px;
    }
    .form-container {
      width: 100%;
      max-width: 900px;
      padding: 20px;
      background: #ffffff;
      border-radius: 20px;
      box-shadow: 0 2px 10px rgb(0, 255, 136);
      margin: 20px;
    }
    .form-group {
  margin-bottom: 15px;
}

label {
  display: block;
  margin-bottom: 5px;
  font-weight: bold;
  text-align: left; /* Align label text properly */
}

input, textarea, select, button {
  width: 100%;
  padding: 10px;
  border: 1px solid #004ef5;
  border-radius: 5px;
  box-sizing: border-box;
}


    button {
      background-color: #007bff;
      color: #fff;
      font-weight: bold;
      cursor: pointer;
      border: none;
    }
    button:hover {
      background-color: #0056b3;
    }
    h2 {
      text-align: left;
      margin-bottom: 20px;
    }

    /* Responsive Design */
    @media (max-width: 600px) {
      .form-container {
        width: 100%;
        padding: 15px;
      }
      input, textarea, select, button {
        width: 100%; 
      }
    }
  </style>
</head>
<body>
  <div class="form-container">
    <h2>Add Product</h2>
    <form id="addproduct">
      <!-- Name -->
      <div class="form-group">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" placeholder="Enter name" required>
      </div>
      
      <!-- Description -->
      <div class="form-group">
        <label for="description">Description:</label>
        <textarea id="description" name="description" rows="3" placeholder="Enter description" required></textarea>
      </div>
      
      <!-- Brand -->
      <div class="form-group">
        <label for="brand">Brand:</label>
        <input type="text" id="brand" name="brand" placeholder="Enter Brand" required>
      </div>

      <!-- Category -->
      <div class="form-group">
        <label for="category">Category:</label>
         <select id="category" name="category" required>
          <option value="sofa">sofa</option>
          <option value="chair">chair</option>
        </select>
      
      </div>

      <!-- Sale Price -->
      <div class="form-group">
        <label for="salePrice">Sale Price:</label>
        <input type="number" id="salePrice" name="salePrice" placeholder="Enter Sale Price" required>
      </div>

      <!-- Product Offer -->
      <div class="form-group">
        <label for="productOffer">Product Offer:</label>
        <input type="number" id="productOffer" name="productOffer" placeholder="Enter Product Offer" required>
      </div>

      <!-- Stock -->
      <div class="form-group">
        <label for="stock">Stock:</label>
        <input type="number" id="stock" name="stock" placeholder="Enter Stock" required>
      </div>
      
      <!-- Status -->
      <div class="form-group">
        <label for="status">Status:</label>
        <select id="status" name="status" required>
          <option value="Available">Available</option>
          <option value="out of stock">out of stock</option>
          <option value="Discontinued">Discontinued</option>
        </select>
      </div>

      <!-- Image Upload Section -->
      <div class="form-group">
        <label for="productImages">Upload Images (Select at least 3):</label>
        <input type="file" id="productImages" name="productImages[]" multiple required>
      </div>
      
      <div id="imagePreview" style="display: flex; gap: 10px; margin-top: 10px;"></div>
      <br>

      <!-- Submit Button -->
      <button type="submit">ADDD</button>
    </form>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script>
    
  


   document.getElementById("productImages").addEventListener("change", function(event) {
  const imagePreview = document.getElementById("imagePreview");
  imagePreview.innerHTML = ""; // Clear any existing previews
  
  const files = event.target.files; // Get selected files
  
  if (files.length < 3) {
    alert("Please select at least 3 images.");
    return;
  }

  Array.from(files).forEach((file) => {
    if (file.type.startsWith("image/")) {
      const reader = new FileReader();
      
      reader.onload = function(e) {
        const img = document.createElement("img");
        img.src = e.target.result; // Set the image source to the file data
        img.style.width = "100px";
        img.style.height = "100px";
        img.style.objectFit = "cover";
        img.style.border = "1px solid #ddd";
        img.style.borderRadius = "5px";
        imagePreview.appendChild(img); // Add the image to the preview container
      };

      reader.readAsDataURL(file); // Read the image file
    } else {
      alert("Please upload only image files.");
    }
  });
});



   document.getElementById("addproduct").addEventListener("submit", function(e) {
  e.preventDefault(); // Prevent form from submitting normally

    

  const name = document.getElementById("name").value;
  const description = document.getElementById("description").value;
  const brand = document.getElementById("brand").value;
  const category = document.getElementById("category").value;
  const salePrice = document.getElementById("salePrice").value;
  const productOffer = document.getElementById("productOffer").value;
  const stock = document.getElementById("stock").value;
  const status = document.getElementById("status").value;
  const imageFiles = document.getElementById("productImages").files;


      
    if (/\s/.test(name)) {
        alert('Name should not contain spaces.');
        return false;
    }

    if (/\s/.test(description)) {
        alert('Description should not contain spaces.');
        return false;
    }

    // Brand validation
    if (/\s/.test(brand)) {
        alert('Brand should not contain spaces.');
        return false;
    }

    
    if (isNaN(salePrice) || salePrice <= 0) {
        alert('Sale Price should be a valid positive number.');
        return false;
    }

   
    if (isNaN(productOffer) || productOffer < 0) {
        alert('Product Offer should be a valid non-negative number.');
        return false;
    }

 
    if (isNaN(stock) || stock < 0) {
        alert('Stock should be a valid non-negative number.');
        return false;
    }

   
  if (!name || !description || !brand || !category || !salePrice || !productOffer || !stock || !status || imageFiles.length < 3) {
    Swal.fire({
      title: 'Error!',
      text: 'Please fill in all required fields and upload at least 3 images.',
      icon: 'error',
      confirmButtonText: 'OK',
    });
    return;
  }

  const formData = new FormData();
  formData.append("name", name);
  formData.append("description", description);
  formData.append("brand", brand);
  formData.append("category", category);
  formData.append("salePrice", salePrice);
  formData.append("productOffer", productOffer);
  formData.append("stock", stock);
  formData.append("status", status);

  // Append image files
  for (let i = 0; i < imageFiles.length; i++) {
    formData.append("productImages", imageFiles[i]); // Note: 'productImages' should match the backend field name
  }

  fetch("/admin/addproduct", {
    method: 'POST',
    body: formData,
  })
  .then(response => {
    if (!response.ok) {
      throw new Error('Network response was not ok');
    }
    return response.json();
  })
  .then(data => {
    Swal.fire({
      title: 'Success!',
      text: 'Product added successfully!',
      icon: 'success',
      confirmButtonText: 'OK',
    }).then(() => {
      window.location.href = '/admin/productManagement';
    });
  })
  .catch(error => {
    Swal.fire({
      title: 'Error!',
      text: 'Something went wrong. Please try again.',
      icon: 'error',
      confirmButtonText: 'OK',
    });
    console.error('Error:', error);
  });
});

  </script>
</body>
</html>